
含有末知函数、末知函数的导函数与自变量之间关系的方程, 叫做微分方程.

末知函数导函数的最高阶数称为该微分方程的阶.

末知函数是一元函数的微分方程称为常微分方程.

如果含有 $n$ 个独立的任意常数的函数

$$
\begin{align*}
	y=\varphi\left(x, C_1, \cdots, C_n\right), \quad a<x<b
\end{align*}
$$

是 $n$ 阶微分方程的解, 则称它为该微分方程通解. 不含任意常数的解称特解.

条件

$$
\begin{align*}
	y\left(x_0\right)=y_0, y^{\prime}\left(x_0\right)=y_0^{\prime}, \cdots, y^{(n-1)}\left(x_0\right)=y_0^{(n-1)}
\end{align*}
$$


称为 $n$ 阶微分方程的初始条件(初值条件), 其中 $y_0, y_0^{\prime}, \cdots, y_0^{(n-1)}$ 为 $n$ 个给定的数.

【注】在解微分方程时约定, 套上积分号后立即将任意常数 $C$ 添上以免将来忘记. 此点约定与不定积分不一样(做不定积分时总是要到积分做完后才添常数 $C$ ).

## 一阶微分方程

### 可分离变量

微分方程 $\frac{ d y}{ d x}=h(x) g(y)$ 称变量可分离的方程, 分离变量$\frac{ d y}{g(y)}=h(x) d x$,
两边积分便得通解

$$
\begin{align*}
	\int \frac{ d y}{g(y)}=\int h(x) d x+C
\end{align*}
$$

分离变量时左右同除需要考虑被除式为零的情况.

<details>
<summary>例题</summary>

微分方程 $y^{\prime}=\frac{y(1-x)}{x}$

$$
\begin{align*}
	\begin{aligned}
		\frac{d y}{d x}     =\frac{y(1-x)}{x} ,
		\int \frac{d y}{y}  =\int \frac{1-x}{x} d x              \\
		\ln |y|             =\ln |x|-x+c_1                       \\
		|y|                 =e^{\ln |x|-x+c_1}=e^{c_1}|x| e^{-x} \\
		y                   = \pm e^{C_1} x e^{-x}=C x e^{-x}
	\end{aligned}
\end{align*}
$$

</details>

### 齐次方程

$$
\begin{align*}
	\begin{array}{l}
		\frac{d y}{d x}=\varphi\left(\frac{y}{x}\right) \\
		\frac{y}{x}=u, \Rightarrow y=x u,
		\frac{d y}{d x}=u+x \frac{d u}{d x} ,
		u+x \frac{d u}{d x}=\varphi(u)
	\end{array}
\end{align*}
$$


<details>

<summary>例题</summary>

$$
eg:(1993年1,2)求微分方程 x ^2 y ^{\prime}+ x y = y ^2 满足初始条件 v(1)=1 的特解.
$$

$$
\begin{align*}
	\begin{aligned}
    & 原方程为齐次方程 y^{\prime}=\left(\frac{y}{x}\right)^2-\frac{y}{x}$, 令 u=\frac{y}{x}, 则\\
    &\text {求微分方程} x ^2 y ^{\prime}+ x y = y ^2 \text{满足初始条件}y(1)=1 \text{的特解} \\
		 & x u^{\prime}+u=u^2-u, \quad x u^{\prime}=u^2-2 u \text {. }    \\
		 & \frac {d u} {u^2 - u}=\frac 1 x {d x} , \frac {u-2} u = Cx^2 ,
		  \frac{y-2 x}{y}=C x^2                                     \\
		 & 由 y(1)=1 , 得 C= -1 ,即所求的特解为:
         \frac{y-2 x}{y}=-x^2 \text {, 即 } y=\frac{2 x}{1+x^2}
	\end{aligned}
\end{align*}
$$

</details>

### 一阶线性微分方程

$$
\begin{align*}
	y^{\prime}+P(x) y=Q(x),
	\text { 通解 } \quad y=e^{-\int p(x) d x}\left[\int Q(x) e^{\int p(x) d x} d x+C\right]
\end{align*}
$$

注:此处$\int \frac{1}{x} d x=\ln x$.

<details>
<summary>例题</summary>
$$
\begin{align*}
&伯努利方程 \frac{ d y}{ d x}=\frac{y}{x+y^3} 的通解为:\\

&【解】方程变为如下形式 \frac{ d x}{ d y}=\frac{x+y^3}{y}=\frac{x}{y}+y^2, 为一阶线性微分方程,\\

&所以原方程的通解为 x= e ^{-\int-\frac{1}{y} dy }\left(C+\int y^2 e ^{-\frac{1}{y} d y} d y\right)=\frac{y^3}{2}+C y, 其中 C 为任意常数.
\end{align*}
$$
</details>


### 伯努利方程

$$
\begin{align*}
	 & y^{\prime}+p(x) y=q(x) y^n ( n \neq 0, n \neq 1 )                \\
	 & 原式化为 y^{-n} \frac{ d y}{ d x}+ p(x) y^{1-n}=q(x). 命 z=y^{1-n}, 得 \\
	 & \frac{1}{1-n} \cdot \frac{ d z}{ d x}+p(x) z=q(x) . \\
	 & 代入线性微分方程的通解公式, 然后再代回为 y, 便得原微分方程的通解.
\end{align*}
$$

<details>
<summary>例题</summary>
\begin{align*}
	\begin{aligned}
		 & 求一阶常微分方程 y^{\prime}-y+2 \frac{x}{y}=0 的通解.                                     \\
		 & 【解】这是一个伯努利方程, 其中p(x)=-1, q(x)=-2 x, n=-1                                       \\
		 & 作变换 z=y^2, z^{\prime}=2 y y^{\prime}, 或 y^{\prime}=\frac{z^{\prime}}{2 y} 代入方程 \\
		 & \frac{z^{\prime}}{2 y}-y+\frac{2 x}{y}=0                                       \\
		 & z^{\prime}-2 z+4 x=0                                                           \\
		 & 这是一个一阶线性常微分方程, 由公式可求得z=C e ^{2 x}+2 x+1                                        \\
		 & 原方程的通解为 y^2=C e ^{2 x}+2 x+1, 其中 C 为任意常数.
	\end{aligned}
\end{align*}
</details>

### 全微分方程

若存在二元函数 $u(x, y)$, 使

$$
\begin{align*}
	\mathrm { d } u (x, y)=P(x, y) d x+Q(x, y) d y
\end{align*}
$$

则称微分方程$P(x, y) d x+Q(x, y) d y=0$
为全微分方程, 它的通解为$u(x, y)=C$.


设 $D$ 为平面上的一个单连通区域, $P(x, y)$ 与 $Q(x, y)$ 在 $D$ 上连续且有连续的一阶偏导数, 则方程为全微分方程的充要条件是

$$
\begin{align*}
	\frac{\partial P}{\partial y}=\frac{\partial Q}{\partial x}, \quad(x, y) \in D
\end{align*}
$$

可以由观察法找 $u(x, y)$, 或者在路径无关条件下找 $u(x, y)$, 或者区域 $D$ 为边平行于坐标轴的矩形条件下,由折线法公式找 $u(x, y)$.

## 二阶及高阶线性微分方程

### 线性微分方程及其性质


方程$y^{(n)}+a_1(x) y^{(n-1)}+\cdots+a_{n-1}(x) y^{\prime}+a_n(x) y=f(x),(f(x)\not \equiv 0)\ \ {\color{red}(1)}$
其中系数 $a_i(x)$ 为已知函数, 称为 $n$ 阶线性非齐次微分方程, $f(x)$ 称为自由项.

方程$y^{(n)}+a_1(x) y^{(n-1)}+\cdots+a_{n-1}(x) y^{\prime}+a_n(x) y=0\ \  {\color{red}(2)}$称为 $n$ 阶线性齐次微分方程.

若其中的 $a_i(x)(i=1,2, \cdots, n)$ 与前一方程的完全一样, 则称后 一方程为前一方程对应的齐次方程.

以上均设 $a_i(x)(i=1,2, \cdots, n)$ 与 $f(x)$ 在某区间 $(a, b)$ 内连续.

- 齐次与非齐次解的关系
    - 设 $y^*(x)$ 为 $(1)$ 的一个解, $Y(x)$ 为 (1) 所对应的 (2) 的一个解, 则 $y=Y(x)+$ $y^*(x)$ 为 (1) 的解.
    - 设 $y_1^*(x)$ 与 $y_2^*(x)$ 为 (1) 的两个解, 则 $y=y_1^*(x)-y_2^*(x)$ 为 (1) 所对应的 (2) 的解.
- 齐次线性方程的解的叠加
    - 设 $y_1(x), \cdots, y_m(x)$ 是齐次线性方程 (2) 的 $m$ 个解, 则它们的线性组合$y=\sum_{i=1}^m C_i y_i$也是 (2) 的解, 其中 $C_i(i=1, \cdots, m)$ 是 $m$ 个常数.
- 齐次线性方程的通解结构
    - 设 $y_i(x)(i=1,2, \cdots, n)$ 为 $n$ 阶齐次线性方程 (2) 的 $n$ 个线性无关的解, $C_i(i=1,2, \cdots$, $n$ ) 为 $n$ 个任意常数,则$y=\sum_{i=1}^n C_i y_i(x)$为 (2) 的通解.
- 非齐次线性方程的通解结构
    - 设 $y^*(x)$ 为 (1) 的一个解, $Y(x)$ 为 (1) 对应的 (2) 的通解, 则 $y=Y(x)+y^*(x)$ 为 (1) 的通解.
- 自由项为 $f(x)=f_1(x)+f_2(x)$ 的解的叠加原理
    - 设 $y_i^*$ 为
		$y^{(n)}+a_1(x) y^{(n-1)}+\cdots+a_{n-1}(x) y^{\prime}+a_n(x) y=f_i(x)$
		的解 $(i=1,2)$, 则 $y_1^*(x)+y_2^*(x)$ 为
		$y^{(n)}+a_1(x) y^{(n-1)}+\cdots+a_{n-1}(x) y^{\prime}+a_n(x) y=f_1(x)+f_2(x)$
		的解.

### 二阶常系数线性齐次方程的通解求法


二阶常系数线性齐次方程可写成

$$
\begin{align*}
	y^{\prime \prime}+p y^{\prime}+q y=0
\end{align*}
$$

其中 $p, q$ 是常数. 方程$r^2+p r+q=0$
称为方程对应的特征方程.

它的根 $r$ 称为特征根. 按特征根的不同情况, 方程对应的通解如下表.

| 特征方程 $r^2+p r+q=0$ 的根                        | $y^{\prime \prime}+p y^{\prime}+q y=0$的通解     |
|:--------------------------------------------------:|:------------------------------------------------:|
| 一对不相等的实根 $r_1 \neq r_2$                    | $y=C_1 e ^{r_1 x}+C_2 e _2^{r_2 x}$              |
| 一对相等的实根 $r_1=r_2$                           | $y=\left(C_1+C_2 x\right) e ^{r_1 x}$            |
| 一对共轭复根 $r_{1,2}=\alpha \pm \beta i, \beta>0$ | $y= e ^{a x}(C_1 \cos \beta x+C_2 \sin \beta x)$ |




### n阶常系数线性齐次微分方程

$$
\begin{align*}
	y^{(n)}+a_1 y^{(n-1)}+\cdots+a_{n-1} y^{\prime}+a_n y=0,
\end{align*}
$$

对应的特征方程

$$
\begin{align*}
	r^n+a_1 r^{n-1}+\cdots+a_{n-1} r+a_n=0
\end{align*}
$$


特征根与微分方程的通解对应关系如下表：

| 特征方程的根                                       | 通解对应的项                                                                                                                        |
|:--------------------------------------------------:|:-----------------------------------------------------------------------------------------------------------------------------------:|
| 单重实根                                           | 对应一项 $C e ^{r x}$                                                                                                              |
| $k$ 重实根 $r$                                     | 对应 $k$ 项 $\left(C_1+C_2 x+\cdots+C_k x^{k-1}\right) e ^{r x}$                                                                    |
| 单重复数根 $r_{1,2}=\alpha \pm \beta i , \beta>0$  | 对应两项 $e ^{a x}\left(C_1 \cos \beta x+C_2 \sin \beta x\right)$                                                                   |
| $k$ 重复数根 $r_{1,2}=\alpha \pm \beta i, \beta>0$ | 对应 $2 k$ 项 $e ^{\alpha x}[\left(A_1+A_2 x+\cdots+A_k x^{k-1}\right) \cos \beta x$ $+(B_1+B_2 x+\cdots+B_k x^{k-1} \sin \beta x]$ |

### 某些特殊自由项的二阶常系数线性非齐次微分方程的解法

$P_m(x)$ 为 $x$ 的 $m$ 次已知多项式

#### $y^{\prime \prime}+p y^{\prime}+q y=P_m(x) e ^{a x}$

第一步, 写出对应的齐次微分方程的通解 $Y(x)$.

第二步,求该非齐次微分方程的特解 $y^*(x)$, 命之如下:

$$
\begin{align*}
y^*(x)=x^k Q_m(x) e ^{a x}
\end{align*}
$$

其中 $Q_m(x)$ 为 $x$ 的 $m$ 次多项式, 系数待定,

$$
\begin{align*}
    k= \begin{cases}0, & \text { 当 } a \text { 不是特征根时 } \\ 1, & \text { 当 } a \text { 为单重特征根时. } \\ 2, & \text { 当 } a \text { 为二重特征根时 }\end{cases}
\end{align*}
$$

#### $y^{\prime \prime}+p y^{\prime}+q y=P_m(x) e ^{a x} \cos b x$ 或 $y^{\prime \prime}+p y^{\prime}+q y=Q_m(x) e ^{a x} \sin b x$ 或 $y^{\prime \prime}+p y^{\prime}+q y=P_m(x) e ^{a x} \cos b x+Q_m(x) e ^{a x} \sin b x$

第一步,  写出对应的齐次微分方程的通解 $Y(x)$. 第二步, 求该非齐次微分方程的特解 $y^*(x)$, 命之如下:

$$
\begin{align*}
 y^*(x)=x^k\left[R_m(x) e ^{a x} \cos b x+S_m(x) e ^{a x} \sin b x\right]
\end{align*}
$$

其中 $R_m(x), S_m(x)$ 为 $x$ 的 $m$ 次多项式, 系数待定,

$$
 \begin{align*}
    k= \begin{cases}0, & \text { 当 } a+ i b \text { 不是特征根时 } \\ 1, & \text { 当 } a+ i b \text { 为单重特征根时 }\end{cases}
   \end{align*}
$$

### 可降阶方程的解法

#### $y^{\prime \prime}=f(x)$

$$
\begin{align*}
    y=\int\left(\int f(x) d x\right) d x+C_1 x+C_2
\end{align*}
$$

#### $y^{\prime \prime}=f\left(x, y^{\prime}\right)$ 型 (缺 $\left.y\right)$

命 $p=y^{\prime}, y^{\prime \prime}=\frac{ d p}{ d x}$, 从而化为

$$
\begin{align*}
	\frac{ d p}{ d x}=f(x, p)
\end{align*}
$$

如果从它可解得 $p=\varphi(x, C_1)$, 则得原方程的通解为 $y=\int \varphi(x, C_1) d x+C_2$.

#### $y^{\prime \prime}=f\left(y, y^{\prime}\right)$ 型 (缺 $\left.x\right)$

命 $p=y^{\prime}, y^{\prime \prime}=\frac{ d p}{ d x}=\frac{ d p}{ d y} \cdot \frac{ d y}{ d x}=p \frac{ d p}{ d y}$, 从而化为

$$
\begin{align*}
    p \cdot \frac{ d p}{ d y}=f(y, p)
\end{align*}
$$

如果能解出$p=\psi\left(y, C_1\right)$,
再由 $p=\frac{ d y}{ d x}$ 代人,解得

$$
\begin{align*}
    \int \frac{ d y}{\psi\left(y, C_1\right)}=\int d x+C_2=x+C_2
\end{align*}
$$

做出左边积分, 便得原微分方程的通解.

必须注意 2 与 3 的区别. 作变量代换 $y^{\prime}=p$ 之后, 对于 $2, y^{\prime \prime}=\frac{ d p}{ d x}$, 而对于 3 ,

$$
\begin{align*}
    y^{\prime \prime}=\frac{ d p}{ d x}=\frac{ d p}{ d y} \cdot \frac{ d y}{ d x}=p \frac{ d p}{ d y}
\end{align*}
$$

### 欧拉方程

方程

$$
\begin{align*}
	x^2 \frac{ d ^2 y}{ d x^2}+a_1 x \frac{ d y}{ d x}+a_2 y=f(x)
\end{align*}
$$


称为欧拉方程, 其中 $a_1$ 与 $a_2$ 为已知常数, $f(x)$ 为 $x$ 的已知函数. 它的解法是:
若 $x>0$,命 $x= e ^t$ 作变量代换, 有 $t=\ln x$, 从而 $\frac{ d t}{ d x}=\frac{1}{x}$,

$$
\begin{align*}
	\begin{gathered}
		\frac{ d y}{ d x}=\frac{ d y}{ d t} \cdot \frac{ d t}{ d x}=\frac{1}{x} \frac{ d y}{ d t} \\
		\frac{ d ^2 y}{ d x^2}=\frac{ d }{ d x}\left(\frac{1}{x} \frac{ d y}{ d t}\right)=-\frac{1}{x^2} \frac{ d y}{ d t}+\frac{1}{x} \frac{ d }{ d x}\left(\frac{ d y}{ d t}\right)=-\frac{1}{x^2} \frac{ d y}{ d t}+\frac{1}{x^2} \frac{ d ^2 y}{ d t^2}
	\end{gathered}
\end{align*}
$$


方程化为 $\quad \frac{ d ^2 y}{ d t^2}+\left(a_1-1\right) \frac{ d y}{ d t}+a_2 y=f\left( e ^t\right)$, 它是常系数线性微分方程, 解之 再还原为 $x$ 便可.


若 $x<0$, 命 $x=- e ^t$, 可依类似处理.
